GAS LISTING task3.S 			page 1


   1              	/*
   2              	 * –ü—Ä–æ–≥—Ä–∞–º–º–∞ –≤–≤–æ–¥–∞ –∫–æ–¥–æ–≤ —Ü–∏—Ñ—Ä–æ–≤—ã—Ö —Å–∏–º–≤–æ–ª–æ–≤ –≤ –±—É—Ñ–µ—Ä –≤ –û–ü
   3              	 */
   4              	
   5              	/*
   6              	 * –ê—Å—Å–µ–º–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ: as -ahlsm=task3.lst --32 -gstabs+ -o task3.o task3.S
   7              	 * –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–≤—è–∑–µ–π: ld -melf_i386 -o task3-exe-S task3.o
   8              	 * –ó–∞–ø—É—Å–∫ –æ—Ç–ª–∞–¥—á–∏–∫–∞: kdbg task3-exe-S
   9              	*/
  10              		
  11              	.include "my-macro"
   1              	/*
   2              	 * –ú–∞–∫—Ä–æ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è —Ä–∞–±–æ—Ç—ã.
   3              	 * –ê—Ä–≥—É–º–µ–Ω—Ç—ã:
   4              	 *     - –∫–æ–¥ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –ø—Ä–æ–≥—Ä–∞–º–º—ã
   5              	 *
   6              	 * –ü–æ—Å–ª–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –º–∞–∫—Ä–æ–≤—ã–∑–æ–≤–∞ –∏–∑–º–µ–Ω—è—é—Ç—Å—è —Ä–µ–≥–∏—Å—Ç—Ä—ã: %e
   7              	 * –°–º. —Ç–∞–∫–∂–µ 'man 2 exit'
   8              	*/
   9              	.macro Exit ret_val
  10              	    movl $1, %eax		# –Ω–æ–º–µ—Ä —Å–∏—Å—Ç. –≤—ã–∑–æ–≤–∞ exit
  11              	    movl \ret_val, %ebx     	# –∫–æ–¥ –≤—ã—Ö–æ–¥–∞
  12              	    int $0x80         		# –≤—ã–ø–æ–ª–Ω–∏—Ç—å —Å–∏—Å—Ç–µ–º–Ω—ã–π –≤—ã–∑–æ–≤
  13              	.endm
  14              	
  15              	
  16              	/*
  17              	 * –ú–∞–∫—Ä–æ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –¥–ª—è —Å—á–∏—Ç—ã–≤–∞–Ω–∏—è –æ–¥–Ω–æ–≥–æ –±–∞–π—Ç–∞ –∫–æ–¥–∞ —Å
  18              	 * —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–≥–æ –≤–≤–æ–¥–∞
  19              	 * –ê—Ä–≥—É–º–µ–Ω—Ç—ã:
  20              	 *     - –∞–¥—Ä–µ—Å –±—É—Ñ–µ—Ä–∞ –¥–ª—è —Å—á–∏—Ç—ã–≤–∞–Ω–∏—è –±–∞–π—Ç–∞
  21              	 * –†–µ–∑—É–ª—å—Ç–∞—Ç:
  22              	 *    - –≤ %eax –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å—á–∏—Ç–∞–Ω–Ω—ã—Ö –±–∞–π—Ç–æ–≤
  23              	 *    - –ø–æ –∞–¥—Ä–µ—Å—É buf_addr - —Å—á–∏—Ç–∞–Ω–Ω—ã–π –±–∞–π—Ç
  24              	 *
  25              	 * –ü–æ—Å–ª–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –º–∞–∫—Ä–æ–≤—ã–∑–æ–≤–∞ –∏–∑–º–µ–Ω—è—é—Ç—Å—è —Ä–µ–≥–∏—Å—Ç—Ä—ã: %e
  26              	 * –°–º. —Ç–∞–∫–∂–µ 'man 2 read'
  27              	*/
  28              	.macro Getchar buf_addr
  29              	    movl $3, %eax		# –Ω–æ–º–µ—Ä —Å–∏—Å—Ç. –≤—ã–∑–æ–≤–∞ read
  30              	    movl $0, %ebx        	# –ø–∞—Ä–∞–º–µ—Ç—Ä 1: –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–≥–æ –≤–≤–
  31              	    movl \buf_addr, %ecx    	# –ø–∞—Ä–∞–º–µ—Ç—Ä 2: –∞–¥—Ä–µ—Å –±—É—Ñ–µ—Ä–∞ (–æ–Ω –∂–µ - —Ñ–∞–∫—Ç–∏—
  32              	                     		# –ø–∞—Ä–∞–º–µ—Ç—Ä –º–∞–∫—Ä–æ–≤—ã–∑–æ–≤–∞)
  33              	    movl $1, %edx        	# –ø–∞—Ä–∞–º–µ—Ç—Ä 3: –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –±–∞–π—Ç–æ–≤ –¥–ª—è —á—Ç–µ–Ω–∏
  34              	    int $0x80        		# –≤—ã–ø–æ–ª–Ω–∏—Ç—å —Å–∏—Å—Ç–µ–º–Ω—ã–π –≤—ã–∑–æ–≤
  35              	.endm
  36              	
  37              	
  38              	/*
  39              	 * –ú–∞–∫—Ä–æ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –¥–ª—è  –≤—ã–≤–æ–¥–∞ —Å—Ç—Ä–æ–∫–∏ –≤ —Ñ–∞–π–ª —Å—Ç–∞–Ω–¥–∞—Ä—Ç–
  40              	 * –ê—Ä–≥—É–º–µ–Ω—Ç—ã:
  41              	 *     - –°—Ç—Ä–æ–∫–∞ –¥–ª—è –≤—ã–≤–æ–¥–∞.
  42              	 *
  43              	 * –ü—Ä–∏–º–µ—Ç—Ä –º–∞–∫—Ä–æ–≤—ã–∑–æ–≤–∞:
  44              	 *    Puts "–¢–µ–∫—Å—Ç –≤—ã–≤–æ–¥–∏–º–æ–π —Å—Ç—Ä–æ–∫–∏"
  45              	 *
  46              	 * –†–µ–∑—É–ª—å—Ç–∞—Ç:
GAS LISTING task3.S 			page 2


  47              	 *    - –≤—ã–≤–æ–¥–∏—Ç –≤ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π –≤—ã–≤–æ–¥ —Å–∏–º–≤–æ–ª—ã –∑–∞–¥–∞–Ω–Ω–æ–π —Å—Ç—Ä–
  48              	 *      –∏ –≤—Å–ª–µ–¥ –∑–∞ –Ω–∏–º–∏ —Å–∏–º–≤–æ–ª –ø–µ—Ä–µ–≤–æ–¥–∞ —Å—Ç—Ä–æ–∫–∏ \n
  49              	 *
  50              	 * –ü–æ—Å–ª–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –º–∞–∫—Ä–æ–≤—ã–∑–æ–≤–∞ –∏–∑–º–µ–Ω—è—é—Ç—Å—è —Ä–µ–≥–∏—Å—Ç—Ä—ã: %e
  51              	 * –°–º. —Ç–∞–∫–∂–µ 'man puts', 'man 2 write'
  52              	*/
  53              	.macro Puts string
  54              	.data
  55              	    str\@:     .ascii "\string\n"	# —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ —Ñ–∞–∫—Ç–∏—á–µ—Å–∫–æ–π —Å—Ç—Ä–æ–∫–∏ –¥
  56              	    strlen\@ =     . - str\@           	# –ø–æ–ª—É—á–µ–Ω–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è –¥–ª–∏–Ω—ã —Å—Ç—Ä–æ–∫
  57              	
  58              	.text
  59              	    movl $4, %eax		# –Ω–æ–º–µ—Ä —Å–∏—Å—Ç. –≤—ã–∑–æ–≤–∞ write
  60              	    movl $1, %ebx		# –ø–∞—Ä–∞–º–µ—Ç—Ä 1: –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–≥–æ –≤—ã–≤–æ–¥–∞
  61              	    movl $str\@, %ecx    	# –ø–∞—Ä–∞–º–µ—Ç—Ä 2: –∞–¥—Ä–µ—Å –ø–∞–º—è—Ç–∏ —Å –≤—ã–≤–æ–¥–∏–º—ã–º–∏ —Å–
  62              	    movl $strlen\@, %edx     	# –ø–∞—Ä–∞–º–µ—Ç—Ä 3: –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –±–∞–π—Ç–æ–≤ –¥–ª—è –≤—ã–≤
  63              	    int $0x80        		# –≤—ã–ø–æ–ª–Ω–∏—Ç—å —Å–∏—Å—Ç–µ–º–Ω—ã–π –≤—ã–∑–æ–≤
  64              	.endm...
  12              	
  13              	.bss
  14              	    .lcomm buf, 100			# 100 –±–∞–π—Ç–æ–≤—ã–π –±—É—Ñ–µ—Ä –¥–ª—è –∫–æ–¥–æ–≤ –ø—Ä–æ—á–∏—Ç–∞–Ω–Ω—ã—Ö —Å
  15              	    .lcomm c, 1    			# –æ–¥–Ω–æ–±–∞–π—Ç–æ–≤—ã–π –±—É—Ñ–µ—Ä –¥–ª—è —á—Ç–µ–Ω–∏—è –±–∞–π—Ç–∞ –∏–∑ —Ñ–
  16              	
  17              	/* 
  18              	 * bss –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –°–µ–∫—Ü–∏—è bss –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è —Ö—Ä–∞–Ω–µ–
  19              	 * –∫–æ—Ç–æ—Ä—ã—Ö –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ –ø—Ä–æ–≥—Ä–∞–º–º—ã –∏–º–µ—é—Ç –Ω—É–ª–µ–≤—ã–µ –∑–Ω–∞—á–µ–Ω–∏
  20              	 * –∏ –∏—Å–ø–æ–ª–Ω—è–µ–º–æ–º —Ñ–∞–π–ª–∞—Ö, –ø–∞–º—è—Ç—å –¥–ª—è –Ω–µ—ë —Ä–∞—Å–ø—Ä–µ–¥–µ–ª—è–µ—Ç –∑–∞
  21              	 * –≤ —Å–µ–∫—Ü–∏–∏ bss –æ–ø—Ä–µ–¥–µ–ª—è—é—Ç—Å—è –¥–∏—Ä–µ–∫—Ç–∏–≤–æ–π .lcomm, –∑–∞–¥–∞—é—â–µ–π –∏–º—
  22              	 * –±–∞–π—Ç–∞—Ö.
  23              	*/
  24              		
  25              	.text
  26              	.global _start
  27              	
  28              	_start:
  29 0000 29F6     	    sub    %esi, %esi     		# —É–∫–∞–∑–∞—Ç–µ–ª—å –∞–¥—Ä–µ—Å–∞ –±–∞–π—Ç–∞ –≤ –±—É—Ñ–µ—Ä–µ buf (–∏–Ω–
  30              	
  31              	show_prompt:
  32              	    Puts "–í–≤–æ–¥–∏—Ç–µ —Ü–∏—Ñ—Ä—É, –¥—Ä—É–≥ –º–æ–π!"	# –º–∞–∫—Ä–æ–≤—ã–∑–æ–≤ –≤—ã–≤–æ–¥–∞ —Å—Ç—Ä–æ
  32              	> .data
  32 0000 D092D0B2 	>  str0:.ascii "–í–≤–æ–¥–∏—Ç–µ —Ü–∏—Ñ—Ä—É, –¥—Ä—É–≥ –º–æ–π!\n"
  32      D0BED0B4 
  32      D0B8D182 
  32      D0B520D1 
  32      86D0B8D1 
  32              	>  strlen0 =. - str0
  32              	> 
  32              	> .text
  32 0002 B8040000 	>  movl $4,%eax
  32      00
  32 0007 BB010000 	>  movl $1,%ebx
  32      00
  32 000c B9000000 	>  movl $str0,%ecx
  32      00
  32 0011 BA2C0000 	>  movl $strlen0,%edx
  32      00
  32 0016 CD80     	>  int $0x80
GAS LISTING task3.S 			page 3


  33              						# —Ñ–∞–π–ª stdout (–ø–æ–¥—Å–∫–∞–∑–∫–∞ –≤–≤–æ–¥–∞)
  34              	
  35              	kbd_input:
  36              	    Getchar $c          		# –º–∞–∫—Ä–æ–≤—ã–∑–æ–≤ –≤–≤–æ–¥–∞ –±–∞–π—Ç–∞ –∏–∑ stdin –≤
  36 0018 B8030000 	>  movl $3,%eax
  36      00
  36 001d BB000000 	>  movl $0,%ebx
  36      00
  36 0022 B9640000 	>  movl $c,%ecx
  36      00
  36              	>  
  36 0027 BA010000 	>  movl $1,%edx
  36      00
  36 002c CD80     	>  int $0x80
  37              						# –ø—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω—ã–π –±—É—Ñ–µ—Ä c –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞
  38              	
  39 002e 83F800   	    cmpl $0, %eax     			# –Ω–∞—Å—Ç—É–ø–∏–ª–æ —Å–æ–±—ã—Ç–∏–µ EOF (–∫–æ–Ω–µ—Ü —Ñ–∞–π–ª–∞ stdin) ?
  40 0031 0F849000 	    je stop        			# –î–∞ - –Ω–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ –ø—Ä–æ–≥—Ä–∞–º–º—ã
  40      0000
  41              		
  42 0037 803D6400 	    cmpb $'\n', c     			# —ç—Ç–æ —Å–∏–º–≤–æ–ª –ø–µ—Ä–µ–≤–æ–¥–∞ —Å—Ç—Ä–æ–∫–∏ ?
  42      00000A
  43              	    // je kbd_input			# –î–ê - –Ω–∞ –≤–≤–æ–¥ —Å–ª–µ–¥—É—é—â–µ–≥–æ —Å–∏–º–≤–æ–ª–∞
  44 003e 746E     	    je eax_input			# –î–ê - –Ω–∞ –≤—ã–≤—ã–æ–¥ —Å–ª–µ–¥—É—é—â–µ–≥–æ –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ —Å–∏–º–≤–
  45 0040 803D6400 	    cmpb $'9', c      			# –∫–æ–¥ –±–æ–ª—å—à–µ –∫–æ–¥–∞ —Å–∏–º–≤–æ–ª–∞ '9' ?
  45      000039
  46 0047 7732     	    ja print_err_msg    		# –î–ê - –Ω–∞ –≤—ã–≤–æ–¥ —Å–æ–æ–±—â–µ–Ω–∏—è –æ–± –æ—à–∏–±–∫–µ
  47 0049 803D6400 	    cmpb $'0', c    			# –∫–æ–¥ –º–µ–Ω—å—à–µ –∫–æ–¥–∞ —Å–∏–º–≤–æ–ª–∞ '0' ?
  47      000030
  48 0050 7229     	    jb print_err_msg    		# –î–ê - –Ω–∞ –≤—ã–≤–æ–¥ —Å–æ–æ–±—â–µ–Ω–∏—è –æ–± –æ—à–∏–±–∫–µ
  49              	
  50 0052 A0640000 	    movb c, %al         		# –ø–µ—Ä–µ–¥–∞—Ç—å –∫–æ–¥ —Å–∏–º–≤–æ–ª–∞ —Ü–∏—Ñ—Ä—ã –∏–∑ c –≤ al
  50      00
  51 0057 83FE64   	    cmpl $100, %esi			# —Å—Ä–∞–≤–Ω–∏–≤–∞–µ–º esi —Å —Ä–∞–∑–º–µ—Ä–æ–º –±—É—Ñ–µ—Ä–∞
  52 005a 743A     	    je print_end_msg			# –î–ê - –Ω–∞ –≤—ã–≤–æ–¥ —Å–æ–æ–±—â–µ–Ω–∏—è –æ –∑–∞–ø–æ–ª–Ω–µ–Ω–∏–∏ –±—É—Ñ–µ
  53 005c 88860000 	    movb %al, buf(%esi) 		# –ø–µ—Ä–µ–¥–∞—Ç—å –∫–æ–¥ —Å–∏–º–≤–æ–ª–∞ —Ü–∏—Ñ—Ä—ã –∏–∑ al –≤ –±–∞–π—Ç
  53      0000
  54              						# –±—É—Ñ–µ—Ä–∞ –ø–æ –∞–¥—Ä–µ—Å—É &buf + esi
  55 0062 46       	    incl %esi       			# —É–∫–∞–∑–∞—Ç—å –Ω–∞ —Å–ª–µ–¥—É—é—â–∏–π –±–∞–π—Ç –±—É—Ñ–µ—Ä–∞ –¥–ª—è
  56              						# —Å–ª–µ–¥—É—é—â–µ–≥–æ –∫–æ–¥–∞
  57              	
  58              	    Puts "–¶–∏—Ñ—Ä–∞! –•–æ—Ä–æ—à–æ." 		# —Å–æ–æ–±—â–µ–Ω–∏—è –æ–± —É—Å–ø–µ—Ö–µ –≤–≤–æ–¥–µ
  58              	> .data
  58 002c D0A6D0B8 	>  str2:.ascii "–¶–∏—Ñ—Ä–∞! –•–æ—Ä–æ—à–æ.\n"
  58      D184D180 
  58      D0B02120 
  58      D0A5D0BE 
  58      D180D0BE 
  58              	>  strlen2 =. - str2
  58              	> 
  58              	> .text
  58 0063 B8040000 	>  movl $4,%eax
  58      00
  58 0068 BB010000 	>  movl $1,%ebx
  58      00
  58 006d B92C0000 	>  movl $str2,%ecx
  58      00
GAS LISTING task3.S 			page 4


  58 0072 BA1A0000 	>  movl $strlen2,%edx
  58      00
  58 0077 CD80     	>  int $0x80
  59              	
  60 0079 EB87     	    jmp show_prompt    			# –Ω–∞ –≤–≤–æ–¥ —Å–ª–µ–¥—É—é—â–µ–≥–æ —Å–∏–º–≤–æ–ª–∞
  61              	
  62              	/*
  63              	 * –ú–∞–∫—Ä–æ–≤–≤—ã–∑–æ–≤ –∏ –º–∞–∫—Ä–æ—Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ Getchar
  64              	 * –ü–æ—è–≤–ª–µ–Ω–∏–µ –≤ –∏—Å—Ö–æ–¥–Ω–æ–º —Ñ–∞–π–ª–µ –º–∞–∫—Ä–æ–≤—ã–∑–æ–≤–∞ Getchar $c –ø—Ä–∏–≤–æ–¥
  65              	 * —Ñ–∞–π–ª –º–∞–∫—Ä–æ—Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è –∫–æ–º–∞–Ω–¥ —Ç–µ–ª–∞ –º–∞–∫—Ä–æ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è, 
  66              	 * –º–∞–∫—Ä–æ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è buf_addr –∑–∞–º–µ–Ω—ë–Ω –Ω–∞ —É–∫–∞–∑–∞–Ω–Ω—ã–π –≤ –º–∞–∫—Ä–æ–≤
  67              	 * $c, - –∞–¥—Ä–µ—Å –æ–¥–Ω–æ–±–∞–π—Ç–æ–≤–æ–≥–æ –±—É—Ñ–µ—Ä–∞, –æ–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω–æ–≥–æ –≤ —Å–µ–∫—Ü
  68              	 * –ó–∞—Ç–µ–º –¥–ª—è —ç—Ç–æ–≥–æ –±—É—Ñ–µ—Ä–∞ —Ñ–æ—Ä–º–∏—Ä—É—é—Ç—Å—è –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –∫–æ–º–∞–Ω
  69              	*/
  70              	
  71              		
  72              	/*
  73              	 * –ú–∞–∫—Ä–æ–≤—ã–∑–æ–≤ –∏ –º–∞–∫—Ä–æ—Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ Puts
  74              	 * –ü–æ—è–≤–ª–µ–Ω–∏–µ –≤ –∏—Å—Ö–æ–¥–Ω–æ–º —Ñ–∞–π–ª–µ –º–∞–∫—Ä–æ–≤—ã–∑–æ–≤–∞ Puts "–¶–∏—Ñ—Ä–∞! –•–æ—
  75              	 * —ç—Ç–æ—Ç —Ñ–∞–π–ª –º–∞–∫—Ä–æ—Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è (–∫–æ–º–∞–Ω–¥ —Ç–µ–ª–∞ –º–∞–∫—Ä–æ–æ–ø—Ä–µ–¥–µ–ª
  76              	 * –º–∞–∫—Ä–æ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è string –∑–∞–º–µ–Ω—ë–Ω –Ω–∞ —É–∫–∞–∑–∞–Ω–Ω—ã–π –≤ –º–∞–∫—Ä–æ–≤—ã
  77              	 * –•–æ—Ä–æ—à–æ."
  78              	*/
  79              		
  80              	print_err_msg:
  81              	    Puts "–ù–µ —Ü–∏—Ñ—Ä–æ–≤–∞—è –∫–ª–∞–≤–∏—à–∞. –ü–æ–≤—Ç–æ—Ä–∏—Ç–µ –≤–≤–æ–¥"	# –≤—ã–≤–æ–¥ —Å–æ–æ–±—
  81              	> .data
  81 0046 D09DD0B5 	>  str3:.ascii "–ù–µ —Ü–∏—Ñ—Ä–æ–≤–∞—è –∫–ª–∞–≤–∏—à–∞. –ü–æ–≤—Ç–æ—Ä–∏—Ç–µ –≤–≤–æ–¥\n"
  81      20D186D0 
  81      B8D184D1 
  81      80D0BED0 
  81      B2D0B0D1 
  81              	>  strlen3 =. - str3
  81              	> 
  81              	> .text
  81 007b B8040000 	>  movl $4,%eax
  81      00
  81 0080 BB010000 	>  movl $1,%ebx
  81      00
  81 0085 B9460000 	>  movl $str3,%ecx
  81      00
  81 008a BA420000 	>  movl $strlen3,%edx
  81      00
  81 008f CD80     	>  int $0x80
  82 0091 E96CFFFF 	    jmp show_prompt				# –Ω–∞ –≤–≤–æ–¥ —Å–ª–µ–¥—É—é—â–µ–≥–æ —Å–∏–º–≤–æ–ª–∞
  82      FF
  83              	
  84              	print_end_msg:
  85              	    Puts "–ë—É—Ñ–µ—Ä –ø–µ—Ä–µ–ø–æ–ª–Ω–µ–Ω"			# –≤—ã–≤–æ–¥ —Å–æ–æ–±—â–µ–Ω–∏—è –æ –ø–µ—Ä–µ–ø–æ–ª–Ω–µ–
  85              	> .data
  85 0088 D091D183 	>  str4:.ascii "–ë—É—Ñ–µ—Ä –ø–µ—Ä–µ–ø–æ–ª–Ω–µ–Ω\n"
  85      D184D0B5 
  85      D18020D0 
  85      BFD0B5D1 
  85      80D0B5D0 
  85              	>  strlen4 =. - str4
  85              	> 
GAS LISTING task3.S 			page 5


  85              	> .text
  85 0096 B8040000 	>  movl $4,%eax
  85      00
  85 009b BB010000 	>  movl $1,%ebx
  85      00
  85 00a0 B9880000 	>  movl $str4,%ecx
  85      00
  85 00a5 BA200000 	>  movl $strlen4,%edx
  85      00
  85 00aa CD80     	>  int $0x80
  86 00ac EB19     	    jmp stop					# –∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ –ø—Ä–æ–≥—Ä–∞–º–º—ã
  87              	
  88              	eax_input:
  89 00ae 89F3     	    movl %esi, %ebx			# –ö–æ–ø–∏—Ä—É–µ–º %esi –≤ %ebx
  90 00b0 4B       	    decl %ebx 				# –£–º–µ–Ω—å—à–∞–µ–º %ebx –Ω–∞ 1
  91 00b1 83FB00   	    cmpl $0, %ebx			# –°—Ä–∞–≤–Ω–∏–≤–∞–µ–º %ebx c 0
  92 00b4 0F8C5EFF 	    jl kbd_input			# –î–ê - –ø–µ—Ä–µ—Ö–æ–¥ –∫ –Ω–∞—á–∞–ª—É –ø—Ä–æ–≥—Ä–∞–º–º—ã
  92      FFFF
  93              						# –Ω–∞ –≤–≤–æ–¥ —Å–ª–µ–¥—É—é—â–µ–≥–æ —Å–∏–º–≤–æ–ª–∞
  94 00ba 8A830000 	    movb buf(%ebx), %al 		# –ö–æ–ø–∏—Ä—É–µ–º —è—á–µ–π–∫—É buf + %ebx –≤ %al
  94      0000
  95 00c0 2C30     	    subb $'0', %al			# –û—Ç–Ω–∏–º–∞–µ–º 30 –æ—Ç –∫–æ–¥–∞ —Å–∏–º–≤–æ–ª–∞ –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —
  96              		 				# –∑–Ω–∞—á–µ–Ω–∏—è
  97 00c2 E951FFFF 	    jmp kbd_input 			# –ü–µ—Ä–µ—Ö–æ–¥ –∫ –Ω–∞—á–∞–ª—É –ø—Ä–æ–≥—Ä–∞–º–º—ã
  97      FF
  98              		
  99              	stop:
 100              	    Exit $0
 100 00c7 B8010000 	>  movl $1,%eax
 100      00
 100 00cc BB000000 	>  movl $0,%ebx
 100      00
 100 00d1 CD80     	>  int $0x80
 101              	
 102              	.end
GAS LISTING task3.S 			page 6


DEFINED SYMBOLS
             task3.S:14     .bss:0000000000000000 buf
             task3.S:14     .bss:0000000000000064 c
             task3.S:28     .text:0000000000000000 _start
             task3.S:31     .text:0000000000000002 show_prompt
             task3.S:32     .data:0000000000000000 str0
             task3.S:32     *ABS*:000000000000002c strlen0
             task3.S:35     .text:0000000000000018 kbd_input
             task3.S:99     .text:00000000000000c7 stop
             task3.S:88     .text:00000000000000ae eax_input
             task3.S:80     .text:000000000000007b print_err_msg
             task3.S:84     .text:0000000000000096 print_end_msg
             task3.S:58     .data:000000000000002c str2
             task3.S:58     *ABS*:000000000000001a strlen2
             task3.S:81     .data:0000000000000046 str3
             task3.S:81     *ABS*:0000000000000042 strlen3
             task3.S:85     .data:0000000000000088 str4
             task3.S:85     *ABS*:0000000000000020 strlen4

NO UNDEFINED SYMBOLS
